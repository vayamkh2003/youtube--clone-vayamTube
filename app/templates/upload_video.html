{% extends 'base.html' %}

{% block content %}

<br>

<p style="text-align: center;" ><strong>Create Video</strong></p>

<form method="post" class="mx-auto" style="width: 50%; margin-top: 10px;" action="{% url 'upload-video' %}" enctype="multipart/form-data">
    {% csrf_token %}

    <label class="form-label">Choose a channel: </label>
    {% for channel in channels %}
        <label class="form-label">
            <input type="radio" class="form-label" name="video_channel" value="{{channel.id}}" required>
            {{channel.name}}
        </label>
    {% endfor %}

    <br>

    <label class="form-label">Choose a video file</label>
    <input type="file" class="form-control" name="video_file" accept="video/*" required>

    <label class="form-label">Title: </label>
    <input type="text" name="video_title" required class="form-control">
    
    <label class="form-label">Description: </label>
    <textarea name="video_description" rows="4" cols="100" class="form-control"></textarea>

    <label class="form-label">Thumbnail: </label>
    <input type="file" name="video_thumbnail" accept="image/*" class="form-control" required>

    <label class="form-label">Category: </label>
    <select name="video_category" class="form-control">
        <option value="">Select Category</option>
        <option value="Music">Music</option>
        <option value="Gaming">Gaming</option>
        <option value="Education">Education</option>
        <option value="Entertainment">Entertainment</option>
        <option value="Technology">Technology</option>
        <option value="Sports">Sports</option>
        <option value="Other">Other</option>
    </select>

    <small class="form-text text-muted">Max video size: 200MB. Thumbnail max size: 5MB.</small>
    <br>

    <button id="uploadBtn" type="submit" class="btn btn-primary">Upload Video</button>
</form>

<script>
document.getElementById('uploadBtn').addEventListener('click', function(e){
    const videoFile = document.querySelector('input[name="video_file"]').files[0];
    const thumbFile = document.querySelector('input[name="video_thumbnail"]').files[0];
    const MAX_VIDEO = 200 * 1024 * 1024; // 200MB
    const MAX_IMG = 5 * 1024 * 1024; // 5MB

    if (videoFile && videoFile.size > MAX_VIDEO){
        e.preventDefault();
        alert('Video file is too large (max 200MB).');
    }
    if (thumbFile && thumbFile.size > MAX_IMG){
        e.preventDefault();
        alert('Thumbnail is too large (max 5MB).');
    }
});
</script>
</form>

{% endblock %}